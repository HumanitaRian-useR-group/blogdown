---
title: "rhdx: a R package to interact with HDX"
author: "Ahmadou Dicko"
date: '2018-12-23'
categories:
  - Data
  - HDX
  - WebData
tags:
  - Ahmadou-Dicko
  - Data-Center
---



<p>rhdx is an R package to interact with the <a href="https://data.humdata.org/">HDX</a> API.</p>
<p>It provide a series of utilities to facilitates interaction &amp; analysis.</p>
<p>The Humanitarian Data Exchange (HDX) is an open platform for sharing data across crises and organisations. Launched in July 2014, the goal of HDX is to make humanitarian data easy to find and use for analysis. Our growing collection of datasets has been accessed by users in over 200 countries and territories.</p>
<!--MORE-->
<div id="install-rhdx" class="section level1">
<h1>Install <code>rhdx</code></h1>
<pre class="r"><code>devtools::install_git(&quot;https://gitlab.com/dickoa/rhdx&quot;)</code></pre>
<pre><code>## 
##   
   checking for file ‘/tmp/Rtmpq12pBI/file32aa49fa60cc/DESCRIPTION’ ...
  
✔  checking for file ‘/tmp/Rtmpq12pBI/file32aa49fa60cc/DESCRIPTION’
## 
  
  
  
─  preparing ‘rhdx’:
##    checking DESCRIPTION meta-information ...
  
✔  checking DESCRIPTION meta-information
## 
  
─  checking for LF line-endings in source and make files and shell scripts
## 
  
─  checking for empty or unneeded directories
## 
  
─  building ‘rhdx_0.1.0.9000.tar.gz’
## 
  
   
## </code></pre>
<pre class="r"><code>devtools::install_github(&quot;dickoa/rhxl&quot;)</code></pre>
<pre class="r"><code>devtools::install_git(&quot;https://gitlab.com/dickoa/rhdx&quot;)
devtools::install_github(&quot;dickoa/rhxl&quot;)</code></pre>
</div>
<div id="connect-to-the-hdx-server" class="section level1">
<h1>Connect to the HDX server</h1>
<pre class="r"><code>library(rhdx)
set_rhdx_config(hdx_site = &quot;prod&quot;)</code></pre>
<p>You can check your config</p>
<pre class="r"><code>get_rhdx_config()</code></pre>
<pre><code>## &lt;HDX Configuration&gt; 
##   HDX site: prod
##   HDX site url: https://data.humdata.org/
##   HDX API key:</code></pre>
</div>
<div id="search-datasets" class="section level1">
<h1>Search datasets</h1>
<div id="list-datasets-matching-a-pattern" class="section level2">
<h2>List datasets matching a pattern</h2>
<pre class="r"><code>library(tidyverse)
search_datasets(&quot;ACLED Mali&quot;, rows = 2)</code></pre>
<pre><code>## [[1]]
## &lt;HDX Dataset&gt; 5895de63-010c-4716-97cb-fbdd3caf4e3a 
##   Title: Mali - Conflict Data
##   Name: acled-data-for-mali
##   Date: 01/01/1997-12/31/2019
##   Tags (up to 5): hxl, protests, security incidents, violence and conflict
##   Locations (up to 5): mli
##   Resources (up to 5): Conflict Data for Mali
## 
## attr(,&quot;class&quot;)
## [1] &quot;datasets_list&quot;</code></pre>
</div>
<div id="select-the-dataset" class="section level2">
<h2>Select the dataset</h2>
<p>We will select the first dataset</p>
<pre class="r"><code>search_datasets(&quot;ACLED Mali&quot;, rows = 2) %&gt;%
  nth(1)</code></pre>
<pre><code>## &lt;HDX Dataset&gt; 5895de63-010c-4716-97cb-fbdd3caf4e3a 
##   Title: Mali - Conflict Data
##   Name: acled-data-for-mali
##   Date: 01/01/1997-12/31/2019
##   Tags (up to 5): hxl, protests, security incidents, violence and conflict
##   Locations (up to 5): mli
##   Resources (up to 5): Conflict Data for Mali</code></pre>
</div>
<div id="list-dataset-resources" class="section level2">
<h2>List dataset resources</h2>
<pre class="r"><code>search_datasets(&quot;ACLED Mali&quot;, rows = 2) %&gt;%
  nth(1) %&gt;%
  get_resources()</code></pre>
<pre><code>## [[1]]
## &lt;HDX Resource&gt; 54b56e5d-571b-4416-a1fa-4000fae6d15b 
##   Name: Conflict Data for Mali
##   Description: Conflict data with HXL tags
##   Size: 
##   Format: CSV</code></pre>
</div>
<div id="we-select-the-first-resource-and-read-it-directly-in-r" class="section level2">
<h2>We select the first resource and read it directly in R</h2>
<pre class="r"><code># library(rhxl)
# search_datasets(&quot;ACLED Mali&quot;, rows = 2) %&gt;%
#   nth(1) %&gt;%
#   get_resources() %&gt;%
#   nth(1) %&gt;%
#   read_session(filename = &quot;acled_mali.csv&quot;, hxl = TRUE)</code></pre>
</div>
<div id="save-it-for-further-use" class="section level2">
<h2>Save it for further use</h2>
<pre class="r"><code># search_datasets(&quot;ACLED Mali&quot;, rows = 2) %&gt;%
#   nth(1) %&gt;%
#   get_resources() %&gt;%
#   nth(1) %&gt;%
#   read_session(filename = &quot;acled_mali.csv&quot;, hxl = TRUE) -&gt; acled_mali</code></pre>
</div>
</div>
<div id="now-lets-see-where-we-have-these-conflicts-in-mali" class="section level1">
<h1>Now let’s see where we have these conflicts in Mali</h1>
<div id="first-step-just-select-the-coordinates" class="section level2">
<h2>First step: just select the coordinates</h2>
<pre class="r"><code># acled_mali %&gt;%
#   select(longitude, latitude) %&gt;%
#   distinct() -&gt; acled_mali_coord
# acled_mali_coord</code></pre>
</div>
<div id="second-step-download-the-official-mali-cod-boundaries-from-hdx" class="section level2">
<h2>Second step download the official Mali COD boundaries from HDX</h2>
<pre class="r"><code># read_dataset(&quot;administrative-boundaries-cod-mli&quot;) %&gt;%
#   get_resources()</code></pre>
<p>We just need the country boundary (admin 0) which is the fourth resource</p>
<pre class="r"><code># read_dataset(&quot;administrative-boundaries-cod-mli&quot;) %&gt;%
#   get_resources() %&gt;%
#   nth(4) %&gt;% 
#   read_session() -&gt; adm0_mali</code></pre>
<p><code>ggplot2</code> is a R package for graphics with a nice grammar to compose any type of visual, we also use <code>sf</code> which add spatial data support.</p>
<pre class="r"><code># library(sf)
# ggplot() +
#   geom_sf(data = adm0_mali) +
#   geom_point(data = acled_mali_coord, aes(x = longitude, y = latitude)) +
#   theme_bw()</code></pre>
</div>
</div>
